<% if p('rabbitmq-server.oauth.enabled') -%>
auth_backends.1 = rabbit_auth_backend_oauth2
auth_backends.2 = rabbit_auth_backend_internal
  <% if p('rabbitmq-server.version') <= '3.10' -%>
management.enable_uaa = true
management.uaa_client_id = <%= p('rabbitmq-server.oauth.uaa_client_id') %>
management.uaa_location = <%= p('rabbitmq-server.oauth.uaa_location') %>
  <% end -%>
  <% if p('rabbitmq-server.version') >= '3.11' -%>
management.oauth_enabled = true
management.oauth_client_id = <%= p('rabbitmq-server.oauth.client_id') %>
management.oauth_client_secret = <%= p('rabbitmq-server.oauth.client_secret') %>
management.oauth_provider_url = <%= p('rabbitmq-server.oauth.provider_url') %>
management.oauth_scopes = openid <%= p('rabbitmq-server.oauth.resource_server_id') %>.*
auth_oauth2.preferred_username_claims = user_name
  <% end -%>
auth_oauth2.resource_server_id = <%= p('rabbitmq-server.oauth.resource_server_id') %>
auth_oauth2.default_key = <%= p('rabbitmq-server.oauth.signing_key_id') %>
auth_oauth2.signing_keys.<%= p('rabbitmq-server.oauth.signing_key_id') %> = /var/vcap/jobs/rabbitmq-server/etc/oAuth-signing-key.pem
<% end -%>
